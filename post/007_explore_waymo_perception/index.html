<!doctype html><!-- This site was created with Wowchemy. https://www.wowchemy.com --><!-- Last Published: March 6, 2025 --><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=generator content="Wowchemy 5.7.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Fira+Code&family=Lora&family=Work+Sans&family=Montserrat:wght@400;700&family=Roboto+Mono:wght@400;700&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Fira+Code&family=Lora&family=Work+Sans&family=Montserrat:wght@400;700&family=Roboto+Mono:wght@400;700&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><script src=/js/mathjax-config.js></script><link rel=stylesheet href=/css/vendor-bundle.min.047268c6dd09ad74ba54a0ba71837064.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/academicons@1.9.2/css/academicons.min.css integrity="sha512-KlJCpRsLf+KKu2VQa5vmRuClRFjxc5lXO03ixZt82HZUk41+1I0bD8KBSA0fY290ayMfWYI9udIqeOWSu1/uZg==" crossorigin=anonymous media=print onload='this.media="all"'><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js integrity crossorigin=anonymous async></script><link rel=stylesheet href=/css/wowchemy.176e9a6c2874fb96332dfb10e8718f70.css><link rel=stylesheet href=/css/libs/chroma/github-dark.min.css title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=/css/libs/chroma/github-dark.min.css title=hl-dark media=print onload='this.media="all"' disabled><meta name=author content="Wit Sirawit"><meta name=description content="The most successful ML projects in production (Tesla, iPhone, Amazon drones, Zipline) are where you own the entire stack. They iterate not just ML algorithms but also: 1) how to collect/label data, 2) infrastructure, 3) hardware ML models run on."><link rel=alternate hreflang=en-us href=https://witsblog.github.io/post/007_explore_waymo_perception/><link rel=canonical href=https://witsblog.github.io/post/007_explore_waymo_perception/><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hu66cf44b0d2eab4dae9de00f68d847da7_1567_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu66cf44b0d2eab4dae9de00f68d847da7_1567_180x180_fill_lanczos_center_3.png><meta name=theme-color content="#2962ff"><meta property="twitter:card" content="summary_large_image"><meta property="twitter:image" content="https://witsblog.github.io/post/007_explore_waymo_perception/featured.png"><meta property="og:site_name" content="Wit's Blog"><meta property="og:url" content="https://witsblog.github.io/post/007_explore_waymo_perception/"><meta property="og:title" content="Waymo Open Dataset | Wit's Blog"><meta property="og:description" content="The most successful ML projects in production (Tesla, iPhone, Amazon drones, Zipline) are where you own the entire stack. They iterate not just ML algorithms but also: 1) how to collect/label data, 2) infrastructure, 3) hardware ML models run on."><meta property="og:image" content="https://witsblog.github.io/post/007_explore_waymo_perception/featured.png"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2021-06-21T00:00:00+00:00"><meta property="article:modified_time" content="2021-06-21T00:00:00+00:00"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://witsblog.github.io/post/007_explore_waymo_perception/"},"headline":"Waymo Open Dataset","image":["https://witsblog.github.io/post/007_explore_waymo_perception/featured.png"],"datePublished":"2021-06-21T00:00:00Z","dateModified":"2021-06-21T00:00:00Z","author":{"@type":"Person","name":"Wit Sirawit"},"publisher":{"@type":"Organization","name":"Wit's Blog","logo":{"@type":"ImageObject","url":"https://witsblog.github.io/media/icon_hu66cf44b0d2eab4dae9de00f68d847da7_1567_192x192_fill_lanczos_center_3.png"}},"description":"The most successful ML projects in production (Tesla, iPhone, Amazon drones, Zipline) are where you own the entire stack. They iterate not just ML algorithms but also: 1) how to collect/label data, 2) infrastructure, 3) hardware ML models run on."}</script><title>Waymo Open Dataset | Wit's Blog</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=d5c6754e02a4cb56fa72fc04d0c12842><script src=/js/wowchemy-init.min.fe8634e7d00f14d07fb33caf14cc8e55.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=Close><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search class=form-control aria-label=Search...></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><div class="page-header header--fixed"><header><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Wit's Blog</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Wit's Blog</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/#posts><span>Posts</span></a></li><li class=nav-item><a class=nav-link href=/#about><span>About</span></a></li><li class=nav-item><a class=nav-link href=/#projects><span>Projects</span></a></li><li class=nav-item><a class=nav-link href=/#gallery><span>Gallery</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=Search><i class="fas fa-search" aria-hidden=true></i></a></li></ul></div></nav></header></div><div class=page-body><article class=article><div class="article-container pt-3"><h1>Waymo Open Dataset</h1><div class=article-metadata><span class=article-date>Jun 21, 2021
</span><span class=middot-divider></span>
<span class=article-reading-time>2 min read</span></div></div><div class="article-header container featured-image-wrapper mt-4 mb-4" style=max-width:1200px;max-height:675px><div style=position:relative><img src=/post/007_explore_waymo_perception/featured_hu81a35f21ff0d29e2e961ad2f4006d804_7720791_1200x2500_fit_q75_h2_lanczos_3.webp width=1200 height=675 alt class=featured-image></div></div><div class=article-container><div class=article-style><blockquote><p>The most successful ML projects in production (Tesla, iPhone, Amazon drones, Zipline) are where you own the entire stack. They iterate not just ML algorithms but also: 1) how to collect/label data, 2) infrastructure, 3) hardware ML models run on.</p></blockquote><p>Summarizing Andrej Karpathy&rsquo;s CVPR talk, Chip Huyen <a href=https://twitter.com/chipro/status/1407890489697652741 target=_blank rel=noopener>highlighted</a> that the most successful ML projects in production are those that have complete ownership of the entire stack. These projects iterate not only on ML algorithms but also on data collection and labeling, infrastructure, and the hardware on which ML models operate.</p><p>Waymo, another major player, released its dataset in 2019, which is in <a href=https://www.tensorflow.org/tutorials/load_data/tfrecord target=_blank rel=noopener>TFRecord</a> format, requiring TensorFlow for reading. This heavy dependence on TensorFlow makes the tools and data preprocessing pipeline less compatible with other frameworks. In contrast, datasets like KITTI, Lyft, TRI, and Argoverse are released in a simpler, raw format. As someone who used PyTorch more than TensorFlow, I found it difficult to inspect and debug the <a href=https://www.tensorflow.org/guide/data target=_blank rel=noopener><code>tf.data</code></a> components when eager execution <em>was</em> not available inside <code>tf.data</code>.</p><p>After a year and listening to Andrej Karpathy&rsquo;s talk at CVPR 2021, I now kind of appreciate why Google&rsquo;s Waymo chose to release their dataset in TFRecord format. Interestingly, the winner of the Challenge used PyTorch though.</p><p>The good news is&mldr; we can now use:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># TensorFlow 2.5</span>
</span></span><span class=line><span class=cl><span class=n>tf</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>experimental</span><span class=o>.</span><span class=n>enable_debug_mode</span><span class=p>()</span>
</span></span></code></pre></div><p>Enough for the introduction, let&rsquo;s visualize the data.</p><h2 id=visualizing-camera-data>Visualizing Camera Data</h2><p>Most of the code is straightforward.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>tensorflow</span> <span class=k>as</span> <span class=nn>tf</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.patches</span> <span class=k>as</span> <span class=nn>patches</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Replace FILENAME with tfrecord file</span>
</span></span><span class=line><span class=cl><span class=n>dataset</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>TFRecordDataset</span><span class=p>(</span><span class=n>FILENAME</span><span class=p>,</span> <span class=n>compression_type</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>data</span> <span class=ow>in</span> <span class=n>dataset</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>frame</span> <span class=o>=</span> <span class=n>open_dataset</span><span class=o>.</span><span class=n>Frame</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>frame</span><span class=o>.</span><span class=n>ParseFromString</span><span class=p>(</span><span class=nb>bytearray</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>numpy</span><span class=p>()))</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=c1># Draw the camera labels.</span>
</span></span><span class=line><span class=cl>    <span class=n>count</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>camera_image</span> <span class=ow>in</span> <span class=n>frame</span><span class=o>.</span><span class=n>images</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>camera_labels</span> <span class=ow>in</span> <span class=n>frame</span><span class=o>.</span><span class=n>camera_labels</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># Ignore camera labels that do not correspond to this camera.</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>camera_labels</span><span class=o>.</span><span class=n>name</span> <span class=o>!=</span> <span class=n>camera_image</span><span class=o>.</span><span class=n>name</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>continue</span>
</span></span><span class=line><span class=cl>            <span class=n>count</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>            <span class=n>ax</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplot</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=n>count</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=c1># Iterate over the individual labels.</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>label</span> <span class=ow>in</span> <span class=n>camera_labels</span><span class=o>.</span><span class=n>labels</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=c1># Draw the object bounding box.</span>
</span></span><span class=line><span class=cl>                <span class=n>ax</span><span class=o>.</span><span class=n>add_patch</span><span class=p>(</span><span class=n>patches</span><span class=o>.</span><span class=n>Rectangle</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                    <span class=n>xy</span><span class=o>=</span><span class=p>(</span><span class=n>label</span><span class=o>.</span><span class=n>box</span><span class=o>.</span><span class=n>center_x</span> <span class=o>-</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=n>label</span><span class=o>.</span><span class=n>box</span><span class=o>.</span><span class=n>length</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=n>label</span><span class=o>.</span><span class=n>box</span><span class=o>.</span><span class=n>center_y</span> <span class=o>-</span> <span class=mf>0.5</span> <span class=o>*</span> <span class=n>label</span><span class=o>.</span><span class=n>box</span><span class=o>.</span><span class=n>width</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                    <span class=n>width</span><span class=o>=</span><span class=n>label</span><span class=o>.</span><span class=n>box</span><span class=o>.</span><span class=n>length</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>height</span><span class=o>=</span><span class=n>label</span><span class=o>.</span><span class=n>box</span><span class=o>.</span><span class=n>width</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>linewidth</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>edgecolor</span><span class=o>=</span><span class=s1>&#39;red&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>facecolor</span><span class=o>=</span><span class=s1>&#39;none&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=c1># Show the camera image.</span>
</span></span><span class=line><span class=cl>            <span class=n>plt</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>tf</span><span class=o>.</span><span class=n>image</span><span class=o>.</span><span class=n>decode_jpeg</span><span class=p>(</span><span class=n>camera_image</span><span class=o>.</span><span class=n>image</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=n>camera_image</span><span class=o>.</span><span class=n>name</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=n>plt</span><span class=o>.</span><span class=n>grid</span><span class=p>(</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>plt</span><span class=o>.</span><span class=n>axis</span><span class=p>(</span><span class=s1>&#39;off&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>plt</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span></code></pre></div><br><p>The following shows some of the dataset.</p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/inUtJcAszXI style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><br><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/S4ZGBSAm7uo style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><br><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/h8X3_4qeGI4 style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><br><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/UwI7cWSBmLo style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><br><h2 id=dataset-statistics>Dataset Statistics</h2><h3 id=3d-labels>3D Labels</h3><div id=chart-579648213 class=chart></div><script>(function(){let e=setInterval(function(){if(typeof window.Plotly=="undefined")return;clearInterval(e),Plotly.d3.json("./lwh_3d_waymo.json",function(e){Plotly.plot("chart-579648213",e.data,e.layout,{responsive:!0})})},500)})()</script><div id=chart-431629785 class=chart></div><script>(function(){let e=setInterval(function(){if(typeof window.Plotly=="undefined")return;clearInterval(e),Plotly.d3.json("./histogram_l.json",function(e){Plotly.plot("chart-431629785",e.data,e.layout,{responsive:!0})})},500)})()</script><div id=chart-584173962 class=chart></div><script>(function(){let e=setInterval(function(){if(typeof window.Plotly=="undefined")return;clearInterval(e),Plotly.d3.json("./histogram_w.json",function(e){Plotly.plot("chart-584173962",e.data,e.layout,{responsive:!0})})},500)})()</script><div id=chart-572198364 class=chart></div><script>(function(){let e=setInterval(function(){if(typeof window.Plotly=="undefined")return;clearInterval(e),Plotly.d3.json("./histogram_h.json",function(e){Plotly.plot("chart-572198364",e.data,e.layout,{responsive:!0})})},500)})()</script><h3 id=2d-labels>2D Labels</h3><div id=chart-872645139 class=chart></div><script>(function(){let e=setInterval(function(){if(typeof window.Plotly=="undefined")return;clearInterval(e),Plotly.d3.json("./bbox_compare.json",function(e){Plotly.plot("chart-872645139",e.data,e.layout,{responsive:!0})})},500)})()</script></div><div class=article-tags><a class="badge badge-light" href=/tag/machine-learning/>Machine Learning</a></div><div class=share-box><ul class=share><li><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fwitsblog.github.io%2Fpost%2F007_explore_waymo_perception%2F&amp;text=Waymo+Open+Dataset" target=_blank rel=noopener class=share-btn-twitter aria-label=twitter><i class="fab fa-twitter"></i></a></li><li><a href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fwitsblog.github.io%2Fpost%2F007_explore_waymo_perception%2F&amp;t=Waymo+Open+Dataset" target=_blank rel=noopener class=share-btn-facebook aria-label=facebook><i class="fab fa-facebook"></i></a></li><li><a href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fwitsblog.github.io%2Fpost%2F007_explore_waymo_perception%2F&amp;title=Waymo+Open+Dataset" target=_blank rel=noopener class=share-btn-linkedin aria-label=linkedin-in><i class="fab fa-linkedin-in"></i></a></li></ul></div></div></article></div><div class=page-footer><div class=container><footer class=site-footer></footer></div></div><script src=/js/vendor-bundle.min.938a3a7554cd9f6602290411f64d2617.js></script><script id=search-hit-fuse-template type=text/x-template>
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script><script src=https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/gh/plotly/plotly.js@v1.55.2/dist/plotly.min.js integrity="sha512-gttPT9uTUiaLBj6XZdcB0ydKXiDaBwstInkN4Qvp1Nz3iwXNc8TTQplIEPIGxyJBDqERjwkKxf2OyO47/0EHbQ==" crossorigin=anonymous></script><script id=page-data type=application/json>{"use_headroom":true}</script><script src=/js/wowchemy-headroom.db4755770454eb63685f8de785c0a172.js type=module></script><script src=/en/js/wowchemy.min.2945731fa88332cb0ec33cf47d29879f.js></script></body></html>